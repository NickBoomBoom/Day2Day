<h2>Python语言中的运算符</h2>
<p>Python 语言支持很多种运算符，下面的表格按照运算符的优先级从高到低，对 Python 中的运算符进行了罗列。有了变量和运算符，我们就可以构造各种各样的表达式来解决实际问题。在计算机科学中，<strong>表达式是计算机程序中的句法实体，它由一个或多个常量、变量、函数和运算符组合而成，编程语言可以对其进行解释和计算以得到另一个值</strong>。不理解这句话没有关系，但是一定要知道，不管使用什么样的编程语言，构造表达式都是非常重要的。</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[]</code>、<code>[:]</code></td>
<td>索引、切片</td>
</tr>
<tr>
<td><code>**</code></td>
<td>幂</td>
</tr>
<tr>
<td><code>~</code>、<code>+</code>、<code>-</code></td>
<td>按位取反、正号、负号</td>
</tr>
<tr>
<td><code>*</code>、<code>/</code>、<code>%</code>、<code>//</code></td>
<td>乘、除、模、整除</td>
</tr>
<tr>
<td><code>+</code>、<code>-</code></td>
<td>加、减</td>
</tr>
<tr>
<td><code>&gt;&gt;</code>、<code>&lt;&lt;</code></td>
<td>右移、左移</td>
</tr>
<tr>
<td><code>&amp;</code></td>
<td>按位与</td>
</tr>
<tr>
<td><code>^</code>、`</td>
<td>`</td>
</tr>
<tr>
<td><code>&lt;=</code>、<code>&lt;</code>、<code>&gt;</code>、<code>&gt;=</code></td>
<td>小于等于、小于、大于、大于等于</td>
</tr>
<tr>
<td><code>==</code>、<code>!=</code></td>
<td>等于、不等于</td>
</tr>
<tr>
<td><code>is</code>、<code>is not</code></td>
<td>身份运算符</td>
</tr>
<tr>
<td><code>in</code>、<code>not in</code></td>
<td>成员运算符</td>
</tr>
<tr>
<td><code>not</code>、<code>or</code>、<code>and</code></td>
<td>逻辑运算符</td>
</tr>
<tr>
<td><code>=</code>、<code>+=</code>、<code>-=</code>、<code>*=</code>、<code>/=</code>、<code>%=</code>、<code>//=</code>、<code>**=</code>、<code>&amp;=</code>、<code>|=</code>、<code>^=</code>、<code>&gt;&gt;=</code>、<code>&lt;&lt;=</code></td>
<td>赋值运算符</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>说明</strong>： 所谓优先级就是在一个运算的表达式中，如果出现了多个运算符，应该先执行什么再执行什么的顺序。编写代码的时候，如果搞不清楚一个表达式中运算符的优先级，可以使用圆括号（小括号）来确保运算的执行顺序。</p>
</blockquote>
<h3>算术运算符</h3>
<p>Python 中的算术运算符非常丰富，除了大家最为熟悉的加、减、乘、除之外，还有整除运算符、求模（求余数）运算符和求幂运算符。下面的例子为大家展示了算术运算符的使用。</p>
<pre><code class="language-python">"""
算术运算符

Version: 1.0
Author: 骆昊
"""
print(321 + 12)     # 加法运算，输出333
print(321 - 12)     # 减法运算，输出309
print(321 * 12)     # 乘法运算，输出3852
print(321 / 12)     # 除法运算，输出26.75
print(321 // 12)    # 整除运算，输出26
print(321 % 12)     # 求模运算，输出9
print(321 ** 12)    # 求幂运算，输出1196906950228928915420617322241
</code></pre>
<p>算术运算需要先乘除后加减，这一点跟数学课本中讲的知识没有区别，也就是说乘除法的运算优先级是高于加减法的。如果还有求幂运算，求幂运算的优先级是高于乘除法的。如果想改变算术运算的执行顺序，可以使用英文输入法状态下的圆括号（小括号），写在圆括号中的表达式会被优先执行，如下面的例子所示。</p>
<pre><code class="language-python">"""
算术运算的优先级

Version: 1.0
Author: 骆昊
"""
print(2 + 3 * 5)           # 17
print((2 + 3) * 5)         # 25
print((2 + 3) * 5 ** 2)    # 125
print(((2 + 3) * 5) ** 2)  # 625
</code></pre>
<h3>赋值运算符</h3>
<p>赋值运算符应该是最为常见的运算符，它的作用是将右边的值赋给左边的变量。赋值运算符还可以跟上面的算术运算符放在一起，组合成复合赋值运算符，例如：<code>a += b</code>相当于<code>a = a + b</code>，<code>a *= a + 2</code>相当于<code>a = a * (a + 2)</code>。下面的例子演示了赋值运算符和复合赋值运算符的使用。</p>
<pre><code class="language-python">"""
赋值运算符和复合赋值运算符

Version: 1.0
Author: 骆昊
"""
a = 10
b = 3
a += b        # 相当于：a = a + b
a *= a + 2    # 相当于：a = a * (a + 2)
print(a)      # 大家算一下这里会输出什么
</code></pre>
<p>赋值运算构成的表达式本身不产生任何值，也就是说，如果你把一个赋值表达式放到<code>print</code>函数中试图输出表达式的值，将会产生语法错误。为了解决这个问题，Python 3.8 中引入了一个新的赋值运算符<code>:=</code>，我们称之为海象运算符，大家可以猜一猜它为什么叫这个名字。海象运算符也是将运算符右侧的值赋值给左边的变量，与赋值运算符不同的是，运算符右侧的值也是整个表达式的值，看看下面的代码大家就明白了。</p>
<pre><code class="language-python">"""
海象运算符

Version: 1.0
Author: 骆昊
"""
# SyntaxError: invalid syntax
# print((a = 10))
# 海象运算符
print((a := 10))  # 10
print(a)          # 10
</code></pre>
<blockquote>
<p><strong>提示</strong>：上面第 8 行代码如果不注释掉，运行代码会看到<code>SyntaxError: invalid syntax</code>错误信息，注意，这行代码中我们给<code>a = 10</code>加上了圆括号，如果不小心写成了<code>print(a = 10)</code>，会看到<code>TypeError: 'a' is an invalid keyword argument for print()</code>错误信息，后面讲到函数的时候，大家就会明白这个错误提示是什么意思了。</p>
</blockquote>
<h3>比较运算符和逻辑运算符</h3>
<p>比较运算符也称为关系运算符，包括<code>==</code>、<code>!=</code>、<code>&lt;</code>、<code>&gt;</code>、<code>&lt;=</code>、<code>&gt;=</code>，我相信大家一看就能懂。需要提醒的是比较相等用的是<code>==</code>，请注意这里是两个等号，因为<code>=</code>是赋值运算符，我们在上面刚刚讲到过。比较不相等用的是<code>!=</code>，跟数学课本中使用的$\small{\neq}$并不相同，Python 2 中曾经使用过<code>&lt;&gt;</code>来表示不等于，在 Python 3 中使用<code>&lt;&gt;</code>会引发<code>SyntaxError</code>（语法错误）。比较运算符会产生布尔值，要么是<code>True</code>，要么是<code>False</code>。</p>
<p>逻辑运算符有三个，分别是<code>and</code>、<code>or</code>和<code>not</code>。<code>and</code>字面意思是“而且”，所以<code>and</code>运算符会连接两个布尔值或者产生布尔值的表达式，如果两边的布尔值都是<code>True</code>，那么运算的结果就是<code>True</code>；左右两边的布尔值有一个是<code>False</code>，最终的运算结果就是<code>False</code>。当然，如果<code>and</code>运算符左边的布尔值是<code>False</code>，不管右边的布尔值是什么，最终的结果都是<code>False</code>，这时运算符右边的布尔值会被跳过（专业的说法叫短路处理，如果<code>and</code>右边是一个表达式，那么这个表达式不会执行）。<code>or</code>字面意思是“或者”，所以<code>or</code>运算符也会连接两个布尔值或产生布尔值的表达式，如果两边的布尔值有任意一个是<code>True</code>，那么最终的结果就是<code>True</code>。当然，<code>or</code>运算符也是有短路功能的，当它左边的布尔值为<code>True</code>的情况下，右边的布尔值会被短路（如果<code>or</code>右边是一个表达式，那么这个表达式不会执行）。<code>not</code>运算符的后面可以跟一个布尔值，如果<code>not</code>后面的布尔值或表达式是<code>True</code>，那么运算的结果就是<code>False</code>；如果<code>not</code>后面的布尔值或表达式是<code>False</code>，那么运算的结果就是<code>True</code>。</p>
<pre><code class="language-python">"""
比较运算符和逻辑运算符的使用

Version: 1.0
Author: 骆昊
"""
flag0 = 1 == 1
flag1 = 3 &gt; 2
flag2 = 2 &lt; 1
flag3 = flag1 and flag2
flag4 = flag1 or flag2
flag5 = not flag0
print('flag0 =', flag0)     # flag0 = True
print('flag1 =', flag1)     # flag1 = True
print('flag2 =', flag2)     # flag2 = False
print('flag3 =', flag3)     # flag3 = False
print('flag4 =', flag4)     # flag4 = True
print('flag5 =', flag5)     # flag5 = False
print(flag1 and not flag2)  # True
print(1 &gt; 2 or 2 == 3)      # False
</code></pre>
<blockquote>
<p><strong>说明</strong>：比较运算符的优先级高于赋值运算符，所以上面的<code>flag0 = 1 == 1</code>先做<code>1 == 1</code>产生布尔值<code>True</code>，再将这个值赋值给变量<code>flag0</code>。<code>print</code>函数可以输出多个值，多个值之间可以用<code>,</code>进行分隔，输出的内容默认以空格分开。</p>
</blockquote>
<h3>运算符和表达式应用</h3>
<h4>例子1：华氏温度转摄氏温度</h4>
<blockquote>
<p><strong>要求</strong>：输入华氏温度将其转换为摄氏温度，华氏温度到摄氏温度的转换公式为： $\small{C = (F - 32) / 1.8}$ 。</p>
</blockquote>
<pre><code class="language-python">"""
将华氏温度转换为摄氏温度

Version: 1.0
Author: 骆昊
"""
f = float(input('请输入华氏温度: '))
c = (f - 32) / 1.8
print('%.1f华氏度 = %.1f摄氏度' % (f, c))
</code></pre>
<blockquote>
<p><strong>说明</strong>：上面代码中的<code>input</code>函数用于从键盘接收用户输入，由于输入的都是字符串，如果想处理成浮点小数来做后续的运算，可以用我们上一课讲解的类型转换的方法，用<code>float</code>函数将<code>str</code>类型处理成<code>float</code>类型。</p>
</blockquote>
<p>上面的代码中，我们对<code>print</code>函数输出的内容进行了格式化处理，<code>print</code>输出的字符串中有两个<code>%.1f</code>占位符，这两个占位符会被<code>%</code>之后的<code>(f, c)</code>中的两个<code>float</code>类型的变量值给替换掉，浮点数小数点后保留1位有效数字。如果字符串中有<code>%d</code>占位符，那么我们会用<code>int</code>类型的值替换掉它，如果字符串中有<code>%s</code>占位符，那么它会被<code>str</code>类型的值替换掉。</p>
<p>除了上面格式化输出的方式外，Python 中还可以用下面的办法来格式化输出，我们给出一个带占位符的字符串，字符串前面的<code>f</code>表示这个字符串是需要格式化处理的，其中的<code>{f:.1f}</code>和<code>{c:.1f}</code>可以先看成是<code>{f}</code>和<code>{c}</code>，表示输出时会用变量<code>f</code>和变量<code>c</code>的值替换掉这两个占位符，后面的<code>:.1f</code>表示这是一个浮点数，小数点后保留1位有效数字。</p>
<pre><code class="language-python">"""
将华氏温度转换为摄氏温度

Version: 1.1
Author: 骆昊
"""
f = float(input('请输入华氏温度: '))
c = (f - 32) / 1.8
print(f'{f:.1f}华氏度 = {c:.1f}摄氏度')
</code></pre>
<h4>例子2：计算圆的周长和面积</h4>
<blockquote>
<p><strong>要求</strong>：输入一个圆的半径（$\small{r}$），计算出它的周长（ $\small{2 \pi r}$ ）和面积（ $\small{\pi r^{2}}$ ）。</p>
</blockquote>
<pre><code class="language-python">"""
输入半径计算圆的周长和面积

Version: 1.0
Author: 骆昊
"""
radius = float(input('请输入圆的半径: '))
perimeter = 2 * 3.1416 * radius
area = 3.1416 * radius * radius
print('周长: %.2f' % perimeter)
print('面积: %.2f' % area)
</code></pre>
<p>Python 中有一个名为<code>math</code> 的内置模块，该模块中定义了名为<code>pi</code>的变量，它的值就是圆周率。如果要使用 Python 内置的这个<code>pi</code>，我们可以对上面的代码稍作修改。</p>
<pre><code class="language-python">"""
输入半径计算圆的周长和面积

Version: 1.1
Author: 骆昊
"""
import math

radius = float(input('请输入圆的半径: '))
perimeter = 2 * math.pi * radius
area = math.pi * radius ** 2
print(f'周长: {perimeter:.2f}')
print(f'面积: {area:.2f}')
</code></pre>
<blockquote>
<p><strong>说明</strong>：上面代码中的<code>import math</code>表示导入<code>math</code>模块，导入该模块以后，才能用<code>math.pi</code>得到圆周率的值。</p>
</blockquote>
<p>这里其实还有一种格式化输出的方式，是 Python 3.8 中增加的新特性，大家直接看下面的代码就明白了。</p>
<pre><code class="language-python">"""
输入半径计算圆的周长和面积

Version: 1.2
Author: 骆昊
"""
import math

radius = float(input('请输入圆的半径: '))  # 输入: 5.5
perimeter = 2 * math.pi * radius
area = math.pi * radius ** 2
print(f'{perimeter = :.2f}')  # 输出：perimeter = 34.56
print(f'{area = :.2f}')       # 输出：area = 95.03
</code></pre>
<blockquote>
<p><strong>说明</strong>：假如变量<code>a</code>的值是<code>9.87</code>，那么字符串<code>f'{a = }'</code>的值是<code>a = 9.87</code>；而字符串<code>f'{a = :.1f}'</code>的值是<code>a = 9.9</code>。这种格式化输出的方式会同时输出变量名和变量值。</p>
</blockquote>
<h4>例子3：判断闰年</h4>
<p>要求：输入一个 1582 年以后的年份，判断该年份是不是闰年。</p>
<pre><code class="language-python">"""
输入年份，闰年输出True，平年输出False

Version: 1.0
Author: 骆昊
"""
year = int(input('请输入年份: '))
is_leap = year % 4 == 0 and year % 100 != 0 or year % 400 == 0
print(f'{is_leap = }')
</code></pre>
<blockquote>
<p><strong>说明</strong>：对于格里历（Gregorian calendar），即今天我们使用的公历，判断闰年的规则是：1. 公元年份非 4 的倍数是平年；2. 公元年份为 4 的倍数但非 100 的倍数是闰年；3. 公元年份为 400 的倍数是闰年。格里历是由教皇格里高利十三世在 1582 年 10 月引入的，作为对儒略历（Julian calendar）的修改和替代，我们在输入年份时要注意这一点。上面的代码通过<code>%</code>来判断<code>year</code>是不是<code>4</code>的倍数、<code>100</code>的倍数、<code>400</code>的倍数，然后用<code>and</code>和<code>or</code>运算符将三个条件组装在一起，前两个条件要同时满足，第三个条件跟前两个条件的组合只需满足其中之一。</p>
</blockquote>
<h3>总结</h3>
<p>通过上面的讲解和例子，相信大家已经感受到了运算符和表达式的力量。实际编程中的很多问题，都需通过构造表达式来解决，所以变量、运算符、表达式对于任何一门编程语言都是极为重要的基础。如果本节课的内容有什么不理解的地方，一定不要着急进入下一课，先在评论区留言讨论，我会及时解答大家的问题。</p>
